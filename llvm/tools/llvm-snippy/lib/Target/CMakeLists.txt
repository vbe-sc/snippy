set(TARGETS_TO_APPEND "")

if(LLVM_TARGETS_TO_BUILD MATCHES "RISCV" OR LLVM_EXPERIMENTAL_TARGETS_TO_BUILD MATCHES "RISCV")
  add_subdirectory(RISCV)
  set(TARGETS_TO_APPEND "${TARGETS_TO_APPEND} RISCV")
endif()

if(CMAKE_BUILD_TYPE STREQUAL "Debug" AND LLVM_TARGETS_TO_BUILD MATCHES "X86")
  add_subdirectory(X86)
  set(TARGETS_TO_APPEND "${TARGETS_TO_APPEND} X86")
endif()

set(LLVM_SNIPPY_TARGETS "${LLVM_SNIPPY_TARGETS} ${TARGETS_TO_APPEND}" PARENT_SCOPE)

add_llvm_library(LLVMSnippyTarget
  DISABLE_LLVM_LINK_LLVM_DYLIB
  STATIC
    Target.cpp
    DBManager.cpp
  DEPENDS
    intrinsics_gen
  )

target_link_libraries(LLVMSnippyTarget PUBLIC LLVMSnippySimulator)
